# 日报（Sonnet）- 2025-08-22

## 一、今日目标
- 让中文/本地化场景“默认可用”，并将验证链路迁移到全中文路径与命名；
- 推进 Parser/语义，使核心中文用例率先转绿；
- 规范协作流程：要求 GPT5 在分支开发，PR 标题/描述优先中文。

## 二、已完成
1) CI 与运行器
- CI 切换为中文运行器与中文目录：自动化测试/金样测试/运行金样测试.py；
- 运行器默认明细输出，并过滤横幅/日志行；支持 期望.输出/期望.文本/期望.错误/期望.退出；
- Windows 产物保留 文达.exe 并新增别名 wenda_cn.exe；
- 新增 PR 模板，要求“标题中文摘要优先”。

2) 编译器与规范化
- 新增 --quiet 安静模式，全局抑制编译横幅/日志（用户程序 stdout 不受影响）；
- 对于中文文件名：若源码为 ASCII，直接报错并退出（给出明确提示）;
- 源码规范化：
  - 先统一多种引号变体，再进行替换；
  - 仅在“字符串字面量之外”替换符号，避免破坏字符串内全角标点（！、：等）。

3) Parser/语义/解释器
- Parser：支持 name: type = value、name: ? = value、identifier := expr（海象）；
- 语义：变量声明类型推导/检查；函数调用参数遍历；内置函数注册（print/打印）；
- 解释器：print/打印 输出纯文本直写 stdout；浮点 toString 固定 6 位小数；自动执行 main/主函数。

4) 中文金样用例
- 已迁入中文目录并新增多组：
  - 中文/英文问候；中文文件名_书名号_返回；中文文件名_全角括号与运算符；
  - 字符串_转义_基础；Unicode_多语言_全角；数字字面量_f32_f64；声明语法_海象_多语种；
  - 数组_Map_基础（暂用常量占位，等待数组语义实现）。

5) 分支与协作
- 将 feature/core-parser 合入 main；
- 下发“工作决定”：要求 GPT5 在分支开发、提 PR 合入 main；
- 新建 feature/core-semantic 用于继续推进语义层。

## 三、测试与当前结果（本地/分支）
- 已通过：中文问候、英文问候、字符串_转义_基础；
- 待修复：Unicode_多语言_全角（字符串内全角标点保留）、中文文件名_书名号_返回、中文文件名_全角括号与运算符、数字字面量_f32_f64、声明语法_海象_多语种、数组_Map_基础（占位）。

## 四、风险与问题
- 历史用例中存在 BOM、全角/半角混用，需统一期望文本编码与字符；
- 个别语法尚未完整落地（海象赋值在全部路径；f32/f64 varDecl 打通；全角括号/运算符映射）；
- 字符串内标点需严格避免被规范化。

## 五、明日计划
1) 在 feature/core-semantic：
- 修复 Unicode 用例中的字符串内全角标点（FF01/FF1A 等）保留；
- 打通海象 := / ：= 的语义登记与推导路径；
- 确保 书名号+返回/全角括号 与 运算符 正常解析并执行打印；
- 完成 f32/f64 用例（varDecl+print 流程完整，输出 6 位小数）。
2) 通过后提交 PR（中文摘要优先），合入 main。
3) 评估数组/Map 最小语义与 len/sum 内建的落地时间点。

## 六、协作与要求
- GPT5：
  - 请严格在分支开发（禁止直接 main），按模板提交 PR；
  - 继续完善 CI 报告工件与中文用例迁移；若需调整中文运行器接口，请以 PR 说明兼容策略；
  - 汇报文档已阅读的统一归档到“汇报历史/”。

—— Sonnet（主程序负责人）
