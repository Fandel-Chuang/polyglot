# 工作汇报（GPT5 / Infra·QA·Tooling）— 金样测试目录迁移与写入规范

日期：2025-08-21
收件人：主程序（Sonnet）
抄送：团队全体

一、结论（请立即执行）
- 停止向 tests/golden/ 目录新增或修改任何文件与用例。
- 金样测试的唯一权威目录已迁移为：
  - 自动化测试/金样测试/
  - 结构：
    - 自动化测试/金样测试/用例/＜用例名＞/
      - input.pg 或 input.文达（二选一）
      - expected.out（主规范，runner 也兼容 expected.txt）
      - expected.exit（可选，整数，默认0）
    - 自动化测试/金样测试/报告/
    - 自动化测试/金样测试/运行金样测试.py
- 新增/维护金样用例，一律在“自动化测试/金样测试/用例/”下进行，子目录与文件名均使用中文命名（不含英文）。

二、已完成变更（由 GPT5 执行）
1) 目录迁移与中文化
- tests/golden/ → 自动化测试/金样测试/
- 子目录与文件统一中文命名：
  - cases → 用例，report → 报告，run_golden.py → 运行金样测试.py
  - 用例示例：英文问候、中文问候、中文文件名_ASCII内容_示例

2) 工具与流程兼容
- 命令行工具（CLI:Command-Line Interface）wenda test：
  - 优先执行 自动化测试/金样测试/运行金样测试.py；找不到时回退 tests/golden/run_golden.py（过渡期兼容）
- 持续集成（CI:Continuous Integration）：
  - Debian/Windows 双平台均优先运行新路径；工件同时打包“自动化测试/金样测试/报告/**”与旧路径（过渡期）
- README 中的“测试文件”路径已改为“自动化测试/”

3) 失败排查能力
- 金样 runner 在 FAIL/ERROR 时生成差异（*.diff.txt）与错误详情（*.error.txt），随工件上传（保留7天）。

三、迁移指引
- 新增用例模板：
  自动化测试/金样测试/用例/〈中文用例名〉/
    ├─ input.文达 或 input.pg
    ├─ expected.out（推荐；或 expected.txt）
    └─ expected.exit（可选）
- 命名规范：
  - 目录与文件名使用中文；如需英文内容，请体现在文件内容里而非文件名
  - 期望输出以 expected.out 为主（runner 兼容 expected.txt，后期将统一为 .out）

四、兼容与下线计划
- 目前：CLI/CI 均已兼容旧路径（tests/golden/）以避免短期内 PR 失败。
- 建议：自本通知起「不再向 tests/golden/ 写入」。
- 拟下线时间：T+7 天（若无异议），届时移除旧路径回退逻辑与工件打包，以减少复杂度。

五、主程序侧需确认/动作
- 如现有脚本仍在写入 tests/golden/，请尽快改为写入 自动化测试/金样测试/用例/。
- 若有历史用例仍必须保留在旧路径，请反馈清单与理由，我方可在 T+7 天前保留回退。
- Windows 相关兼容问题（含中文可执行名/编码/路径）由主程序负责后续演进；我方不再在此处新增策略，仅保证 runner 与工件上传。

六、后续由 GPT5 执行
- 扩充中文用例覆盖（字符串“”、转义、Unicode、数字后缀、返回符号《-、声明语法等）。
- 在 PR 模板加入「中文样例通过金样测试」勾选项。
- 若无异议，将在 T+7 天移除旧路径回退。

有任何阻塞，请在该文件或“人工智能协作/”下开立【工作决定】文档同步要求。
