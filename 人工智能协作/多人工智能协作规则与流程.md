# 多人工智能协作规则与流程

本文件定义多智能体（多人机协作）在本仓库的规范与流程，用于保障协作效率与变更可追溯性。

## 1. 角色与分工
- 主程序（Sonnet）：编译器核心、Windows 兼容、语义/代码生成等主职责。
- GPT5（Infra/QA/Tooling）：命令行工具（CLI:Command-Line Interface）、持续集成（CI:Continuous Integration）、金样测试、标准库雏形、协作规范。
- 其他智能体/贡献者：按任务卡与工作决定执行。

## 2. 目录与命名约定
- 自动化测试/金样测试/：金样测试的唯一权威目录
  - 用例/〈中文用例名〉/（仅中文命名）
    - input.pg 或 输入.文达（二选一）
    - 期望.输出
    - 期望.退出（可选，默认 0）
  - 报告/（CI 工件下载目录，不纳入版本控制）
  - 运行金样测试.py（金样测试驱动脚本）
- 不再向 tests/golden/ 写入新内容；过渡期仅作为回退兼容，拟 T+7 天下线。

## 3. 工作决定（Decision）管理流程
- 工作决定由“你或主程序”编写，文件名：工作决定_*.md。
- 阅读与执行后，由 GPT5 归档至：人工智能协作/工作决定历史/。
- 归档规则：
  1) 仅归档已阅读/已执行的历史决定；
  2) 顶层仅保留“当前有效”的决定（如需长期有效由作者明确标注）；
  3) 决定文件不做内容修改，如需变更另起新决定文档。

## 4. PR 流程与门槛
- 所有 PR 必须：
  - 通过持续集成（CI:Continuous Integration）
  - 通过金样测试（如涉及中文语法/符号/示例）
  - 使用 PR 模板并勾选“中文样例通过金样测试（自动化测试/金样测试）”
- 建议使用 Squash 合并，保持主干清晰。

## 5. CI/测试规范
- GitHub Actions：
  - Debian 容器（debian:bookworm-slim）与 Windows 双平台
  - 运行 自动化测试/金样测试/运行金样测试.py，失败时上传 diff/error 工件（保留 7 天）
- 失败排查：
  - 查看 Actions 的 Artifacts（golden-report-*），下载报告与差异文件

## 6. 变更落地策略
- 大改动先出“工作汇报_*.md”，经主程序审阅后由其形成“工作决定_*.md”
- GPT5 按“工作决定”落地，并在日报中反馈进度

## 7. 代码与文档中文化
- 测试、用例、脚本、目录命名尽量中文化；必要英文保留在内容层（如源码字符串）
- 对外接口与跨平台工具保留英文/双语（例如 CLI 子命令），以便生态与脚本调用

## 8. 回退与兼容
- 目录迁移采用“新路径优先 + 旧路径回退”的策略，待稳定后下线回退路径
- Windows 侧兼容问题由主程序负责；GPT5 不修改产物命名，仅在工具链与 CI 侧做兼容

（本文件将随协作演进持续迭代）